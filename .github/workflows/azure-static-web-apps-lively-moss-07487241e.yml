steps:
  - uses: actions/checkout@v3
  
  - name: Setup Node.js
    uses: actions/setup-node@v3
    with:
      node-version: '20'
      cache: 'npm'

  - name: Install dependencies
    run: |
      # Limpiar instalaciones previas
      rm -rf node_modules
      rm -f package-lock.json
      
      # Instalar dependencias principales
      npm install
      
      # Instalar Rollup explícitamente (sin el paquete Linux específico)
      npm install rollup@3.29.4 --save-dev

  - name: Build And Deploy
    uses: Azure/static-web-apps-deploy@v1
    with:
      azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN_LIVELY_MOSS_07487241E }}
      action: "upload"
      app_location: "/"
      api_location: ""
      output_location: "public"
